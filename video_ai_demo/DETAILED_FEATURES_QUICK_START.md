# 详细特征功能快速上手

## 🎯 核心改进

系统现在支持**两层特征展示**：

| 视图层级 | 位置 | 显示内容 | 适用场景 |
|---------|------|---------|---------|
| **简洁视图** | 时间轴特征通道 | 简单特征名称 | 快速浏览、概览 |
| **详细视图** | 右侧详情面板 | 专业解读、参数、意义 | 深入分析、学习 |

## 🚀 快速开始

### 1. 确保配置 API Key

```bash
cd /Users/tang/GitProj/Intuition-X/video_ai_demo
nano .env
```

添加：
```bash
MM_LLM_API_KEY=你的实际API密钥
```

### 2. 重启服务

```bash
uvicorn app.main:app --reload --port 8000
```

### 3. 提交分析任务

使用前端界面或 API：

```bash
curl -X POST "http://localhost:8000/v1/video-analysis/jobs" \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "learn",
    "target_video": {
      "source": {
        "type": "file",
        "path": "/path/to/your/video.mp4"
      }
    }
  }'
```

### 4. 查看结果

- **时间轴**：看到简洁的特征名称（如"缓慢推镜"）
- **点击片段**：右侧弹出详情面板，显示完整解读

## 📊 新增数据字段

每个特征现在可以包含 `detailed_description`：

```javascript
{
  value: "缓慢推镜",           // 简洁名称（轨道显示）
  detailed_description: {      // 详细解读（面板显示）
    summary: "摄像机以缓慢的速度向拍摄主体推进...",
    technical_terms: ["推镜头", "Dolly In"],
    purpose: "引导观众注意力聚焦到主体...",
    parameters: {
      speed: "缓慢",
      distance: "中距离推进"
    },
    diagram: "光路图示意"  // 仅 lighting 类别
  }
}
```

## 🎨 特征类别详解

### 运镜 (camera_motion)

**详细描述包含：**
- 📝 简要描述：运镜方式说明
- 🏷️ 专业术语：中英文术语
- 🎯 镜头意义：艺术效果和情感表达
- ⚙️ 技术参数：速度、距离、焦距变化等

### 光线 (lighting)

**详细描述包含：**
- 📝 简要描述：光线布局说明
- 🏷️ 专业术语：光源类型
- 🎯 光线效果：氛围营造
- ⚙️ 光源配置：主光、补光、轮廓光位置和比例
- 🗺️ 光路图：可视化光源布局

### 调色 (color_grading)

**详细描述包含：**
- 📝 简要描述：调色风格说明
- 🏷️ 专业术语：调色方案名称
- 🎯 整体氛围：情感和视觉感受
- ⚙️ 调色参数：色温、饱和度、对比度、偏移等

## 💡 使用技巧

### 1. 快速浏览
在时间轴上快速扫视，通过简洁的特征名称了解整体风格

### 2. 深入分析
点击感兴趣的片段，在详情面板查看：
- 专业术语学习
- 镜头意义理解
- 技术参数参考

### 3. 对比学习
在 Compare 模式下：
- 对比两个视频的特征差异
- 学习目标视频的专业手法
- 获得具体的改进建议

## 🔧 自定义 Prompt

如果需要定制输出，编辑：

```python
# app/integrations/mm_llm_client.py
# 找到 _build_feature_analysis_prompt 方法
# 根据需求修改提示词
```

## 📱 前端交互

### 时间轴视图
```
┌─────────────────────────────────────────┐
│ 视频片段 │ seg_001 │ 3.5s             │
├─────────────────────────────────────────┤
│ 运镜     │ 缓慢推镜                    │  ← 简洁
├─────────────────────────────────────────┤
│ 光线     │ 三点布光                    │  ← 简洁
├─────────────────────────────────────────┤
│ 调色     │ 暖色调                      │  ← 简洁
└─────────────────────────────────────────┘
```

### 详情面板（点击后）
```
┌─────────────────────────────────────────┐
│ 📹 运镜分析                             │
│                                         │
│ [缓慢推镜] 85%                          │
│                                         │
│ 简要描述：                               │
│ 摄像机以缓慢的速度向拍摄主体推进...      │
│                                         │
│ 专业术语：                               │
│ [推镜头] [Dolly In] [景深变化]          │  ← 详细
│                                         │
│ 镜头意义：                               │
│ 引导观众注意力聚焦到主体，营造逐渐...    │  ← 详细
│                                         │
│ 技术参数：                               │
│ • speed: 缓慢                           │  ← 详细
│ • distance: 中距离推进                   │  ← 详细
└─────────────────────────────────────────┘
```

## 🎓 学习模式

### 新手模式
1. 先看时间轴的简洁名称
2. 点击查看详细解读
3. 学习专业术语和意义

### 专家模式
1. 时间轴快速定位
2. 详情面板查看参数
3. 用于技术复现

## 🐛 故障排除

### 问题：没有显示详细描述

**原因：**
- API Key 未配置
- 模型没有返回 `detailed_description` 字段

**解决：**
1. 检查 `.env` 文件中的 `MM_LLM_API_KEY`
2. 重启服务
3. 查看日志确认 LLM 调用成功

### 问题：详情面板不弹出

**原因：**
- JavaScript 错误
- 片段数据格式问题

**解决：**
1. 打开浏览器开发者工具（F12）
2. 查看 Console 错误信息
3. 检查 Network 标签确认 API 返回数据

## 📚 相关文档

- [完整功能指南](./FEATURE_DETAIL_GUIDE.md)
- [API 文档](http://localhost:8000/docs)
- [项目 README](./README.md)

## ✅ 功能清单

- [x] Schema 扩展（支持 `detailed_description`）
- [x] LLM Prompt 优化（输出详细描述）
- [x] 前端详情面板（渲染详细信息）
- [x] 兼容性保证（可选字段，向后兼容）
- [x] 样式优化（专业术语、参数、光路图）

## 🎉 开始使用

现在就开始分析你的视频，体验专业的影视特征解读功能吧！

