<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video AI Analysis - 视频智能分析</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎬</text></svg>">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="top-nav">
        <div class="nav-content">
            <div class="nav-left">
                <h1 class="logo">🎬 Video AI</h1>
            </div>
            <div class="nav-center">
                <button class="nav-tab active" data-mode="learn">Learn</button>
                <button class="nav-tab" data-mode="history">History</button>
            </div>
            <div class="nav-right">
                <button class="btn-toggle-sidebar" id="btn-toggle-sidebar" title="显示/隐藏侧边栏">☰</button>
                <button class="btn-secondary" id="btn-help">帮助</button>
            </div>
        </div>
    </nav>

    <!-- 主容器 -->
    <div class="container">
        <!-- 侧边栏 - 上传区域 -->
        <aside class="sidebar">
            <div class="upload-section">
                <h2 class="section-title">视频上传</h2>
                
                <!-- Target Video -->
                <div class="upload-card">
                    <div class="card-header">
                        <span class="card-icon">🎯</span>
                        <span class="card-title">目标视频</span>
                    </div>
                    <div class="upload-area" id="target-upload">
                        <input type="file" id="target-file" accept="video/*" style="display: none;">
                        <div class="upload-placeholder">
                            <div class="upload-icon">📁</div>
                            <p class="upload-text">点击或拖拽视频文件</p>
                            <p class="upload-hint">支持 MP4, MOV, AVI</p>
                        </div>
                        <div class="file-info" style="display: none;">
                            <div class="file-name"></div>
                            <button class="btn-remove">×</button>
                        </div>
                    </div>
                </div>

                <!-- User Video (Compare模式) -->
                <div class="upload-card" id="user-video-card" style="display: none;">
                    <div class="card-header">
                        <span class="card-icon">👤</span>
                        <span class="card-title">用户视频</span>
                    </div>
                    <div class="upload-area" id="user-upload">
                        <input type="file" id="user-file" accept="video/*" style="display: none;">
                        <div class="upload-placeholder">
                            <div class="upload-icon">📁</div>
                            <p class="upload-text">点击或拖拽视频文件</p>
                        </div>
                        <div class="file-info" style="display: none;">
                            <div class="file-name"></div>
                            <button class="btn-remove">×</button>
                        </div>
                    </div>
                </div>

                <!-- 分析选项 -->
                <div class="options-card">
                    <h3 class="options-title">分析选项</h3>
                    <div class="option-group">
                        <label class="option-label">抽帧率 (fps)</label>
                        <input type="number" class="option-input" id="fps" value="1" min="0.5" max="5" step="0.5">
                    </div>
                    <div class="option-group">
                        <label class="option-label">最大帧数</label>
                        <input type="number" class="option-input" id="max-frames" value="20" min="5" max="100" step="5">
                    </div>
                    <div class="option-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-camera" checked> 运镜分析
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-lighting" checked> 光线分析
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-color" checked> 调色分析
                        </label>
                    </div>
                    <p class="option-hint">💡 后端会分析所有特征，复选框只控制显示</p>
                </div>

                <!-- 开始分析按钮 -->
                <button class="btn-primary btn-analyze" id="btn-analyze" disabled>
                    <span class="btn-icon">✨</span>
                    开始分析
                </button>
            </div>
        </aside>

        <!-- 主内容区 - 时间轴 -->
        <main class="main-content">
            <!-- 空状态 -->
            <div class="empty-state" id="empty-state">
                <div class="empty-icon">🎥</div>
                <h2 class="empty-title">上传视频开始分析</h2>
                <p class="empty-text">支持Learn和Compare两种模式</p>
            </div>

            <!-- 加载状态 -->
            <div class="loading-state" id="loading-state" style="display: none;">
                <div class="loading-spinner"></div>
                <h2 class="loading-title">分析中...</h2>
                <p class="loading-text" id="loading-progress">准备中 0%</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>

            <!-- 结果展示 - PR风格时间轴 -->
            <div class="timeline-container" id="timeline-container" style="display: none;">
                <!-- 时间轴头部 -->
                <div class="timeline-header">
                    <div class="timeline-info">
                        <h2 class="timeline-title">分析结果</h2>
                        <span class="timeline-subtitle" id="timeline-subtitle">2个镜头 · 20秒</span>
                    </div>
                    <div class="timeline-controls">
                        <button class="btn-icon-only" id="btn-zoom-out" title="缩小">−</button>
                        <button class="btn-icon-only" id="btn-zoom-in" title="放大">+</button>
                        <button class="btn-secondary" id="btn-test-playhead" style="display:none;">测试播放头</button>
                        <button class="btn-secondary" id="btn-export">导出结果</button>
                    </div>
                </div>

                <!-- 时间标尺 -->
                <div class="timeline-ruler" id="timeline-ruler"></div>

                <!-- 视频预览轨道 - 固定不滚动 -->
                <div class="track video-preview-track fixed-track">
                    <div class="track-header">
                        <span class="track-icon">📹</span>
                        <span class="track-name">视频预览</span>
                        <button class="btn-track-control" id="btn-toggle-video" title="显示/隐藏">👁️</button>
                    </div>
                    <div class="track-content video-preview-content" id="video-preview-content">
                        <video id="preview-video" class="preview-video" controls></video>
                        <div class="video-overlay" id="video-overlay"></div>
                    </div>
                </div>

                <!-- 轨道区域 - 可滚动 -->
                <div class="tracks-container" id="tracks-container">
                    <!-- 播放头竖线 -->
                    <div class="playhead" id="playhead"></div>

                    <!-- 视频片段轨道 -->
                    <div class="track video-track">
                        <div class="track-header">
                            <span class="track-icon">🎬</span>
                            <span class="track-name">镜头片段</span>
                        </div>
                        <div class="track-content" id="video-segments"></div>
                    </div>

                    <!-- 运镜轨道 -->
                    <div class="track feature-track">
                        <div class="track-header">
                            <span class="track-icon">📹</span>
                            <span class="track-name">运镜</span>
                        </div>
                        <div class="track-content" id="camera-track"></div>
                    </div>

                    <!-- 光线轨道 -->
                    <div class="track feature-track">
                        <div class="track-header">
                            <span class="track-icon">💡</span>
                            <span class="track-name">光线</span>
                        </div>
                        <div class="track-content" id="lighting-track"></div>
                    </div>

                    <!-- 调色轨道 -->
                    <div class="track feature-track">
                        <div class="track-header">
                            <span class="track-icon">🎨</span>
                            <span class="track-name">调色</span>
                        </div>
                        <div class="track-content" id="color-track"></div>
                    </div>
                </div>

                <!-- 播放控制 -->
                <div class="playback-controls">
                    <button class="btn-play" id="btn-play">▶</button>
                    <div class="time-display" id="time-display">00:00.000</div>
                    <div class="playback-slider" id="playback-slider">
                        <div class="playback-progress" id="playback-progress"></div>
                        <div class="playback-handle" id="playback-handle"></div>
                    </div>
                    <div class="time-display" id="time-total">00:00.000</div>
                    <button class="btn-secondary btn-small" id="btn-fullscreen">全屏</button>
                </div>
            </div>

            <!-- 详情面板 -->
            <div class="detail-panel" id="detail-panel">
                <div class="detail-header">
                    <h3 class="detail-title">镜头详细分析</h3>
                    <button class="btn-close" id="btn-close-detail">×</button>
                </div>
                <div class="detail-content" id="detail-content">
                    <div class="detail-loading">加载中...</div>
                </div>
            </div>
        </main>
    </div>

    <script src="/static/js/feature-meanings.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>

